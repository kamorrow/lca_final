---
title: "Analysis of Beverage Containers"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library("tidyverse")
library("janitor")
library("ggsci")
library("knitr")
library("kableExtra")
library("here")
```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# Read in and clean data

aluminum_clean <- read_csv(here::here("data", "aluminum_final.csv")) %>%
  clean_names() %>%
  rename("category" = "x1") %>%
  rename("base" = "medium") %>%
  mutate(type = "aluminum") %>%
  drop_na()

pet_clean <- read_csv(here::here("data", "pet_final.csv")) %>%
  clean_names() %>%
  rename("category" = "x1") %>%
  mutate(type = "PET") %>%
  rename("base" = "medium") %>%
  drop_na() 

glass_clean <- read_csv(here::here("data", "glass_final.csv")) %>%
  clean_names() %>%
  rename("category" = "x1") %>%
  rename("base" = "medium") %>%
  mutate(type = "glass") %>%
  drop_na()
```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#Combine data for can, and both bottles and save it

all_data <- rbind(glass_clean, pet_clean, aluminum_clean)

# write_csv(all_data, 'all_data.csv')
```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# Clean up in excel and read back in

all_data_clean <- read_csv(here::here("data", "all_data_clean.csv"))

# Retrieve categories of interest

sel_data <- all_data_clean %>%
  filter(category %in% c("Acidification", "Ecotoxicity", "Eutrophication", "Global Warming Air", "Smog Air", "Human Toxicity (cancer)", "Human Toxicity (non-cancer)"))

# Final data for each container

al_sel <- sel_data %>%
  filter(type == "aluminum") %>%
  select(-type, -epa_eq, -low, -high, -base, -unit) %>%
  pivot_longer(!category, names_to = "scenario", values_to = "amount") %>%
  mutate(scenario = fct_relevel(scenario, "high_norm", "base_norm", "low_norm"))

glass_sel <- sel_data %>%
  filter(type == "glass") %>%
  select(-type, -epa_eq, -low, -high, -base, -unit) %>%
  pivot_longer(!category, names_to = "scenario", values_to = "amount") %>%
  filter(scenario != "high_norm") %>%
  mutate(scenario = fct_relevel(scenario, "low_norm", "base_norm"))

pet_sel <- sel_data %>%
  filter(type == "PET") %>%
  select(-type, -epa_eq, -low, -high, -base, -unit) %>%
  pivot_longer(!category, names_to = "scenario", values_to = "amount") %>%
  mutate(scenario = fct_relevel(scenario, "high_norm", "base_norm", "low_norm"))

all_sel <- sel_data %>%
  select(-epa_eq, -low, -high, -base, -low_norm, -high_norm, -unit)# %>%
  # pivot_longer(!category, !type, names_to = "scenario", values_to = "amount") %>%
  # mutate(scenario = fct_relevel(scenario, "high_norm", "base_norm", "low_norm"))

```

```{r}
# All containers

ggplot(all_sel, 
       aes(y= base_norm,
           fill = type,
           x = category)) +
  geom_bar(stat = "identity",
           position = position_dodge(),
           show.legend = TRUE) +
  scale_fill_futurama() +
  # coord_flip() +
  scale_fill_futurama(name = "Container Type:",
                      labels = c("Aluminum",
                                 "Glass",
                                 "PET")) +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Environmental Impact",
       subtitle = "Reference Flow: All Container Types",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())


ggsave(here::here("figures", "all_impact_f2.png"), height = 6, width = 8)

```



```{r}
# ALUMINUM

ggplot(al_sel, 
       aes(y= amount,
           fill = scenario,
           x = category)) +
  geom_bar(stat = "identity",
           position = position_dodge(),
           show.legend = TRUE) +
  scale_fill_futurama() +
  # coord_flip() +
  scale_fill_futurama(name = "Recycling Scenarios:",
  labels = c("High (100% recycling)",
             "Baseline (50% recycling)",
             "Low (0% recycling)")) +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Environmental Impact",
       subtitle = "Aluminum Can",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())


ggsave(here::here("figures", "aluminum_f2.png"), height = 6, width = 8)
```

```{r}
# GLASS

ggplot(glass_sel, 
       aes(y= amount,
           fill = scenario,
           x = category)) +
  geom_bar(stat = "identity",
           position = position_dodge(),
           show.legend = TRUE) +
  scale_fill_futurama() +
  # coord_flip() +
  scale_fill_futurama(name = "Bottle Mass Scenarios:",
                 labels = c("Low (450g bottle mass)",
                            "Baseline (570g bottle mass)")) +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Environmental Impact",
       subtitle = "Glass Bottle",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())


ggsave(here::here("figures", "glass_f2.png"), height = 6, width = 8)
```

```{r}
# PET

ggplot(pet_sel, 
       aes(y= amount,
           fill = scenario,
           x = category)) +
  geom_bar(stat = "identity",
           position = position_dodge(),
           show.legend = TRUE) +
  scale_fill_futurama() +
  # coord_flip() +
  scale_fill_futurama(name = "Recycling Scenarios:",
                 labels = c("High (90% recycling)",
                            "Baseline (30% recycling)",
                            "Low (0% recycling)")) +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Environmental Impact",
       subtitle = "PET Bottle",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())


ggsave(here::here("figures", "PET_f2.png"), height = 6, width = 8)
```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=TRUE}
# Contribution: Aluminum


al_cont_long <- read_csv(here::here("data", "aluminum_contribution.csv")) %>%
  select(production_norm, transportation_norm, end_of_life_norm, Category) %>%
  pivot_longer(!Category, names_to = "phases", values_to = "amount")

sel_al_cont_long <-  al_cont_long %>% 
  filter(Category %in% c("Acidification",
                         "Ecotoxicity",
                         "Eutrophication",
                         "Global Warming Air",
                         "Smog Air",
                         "Human Toxicity (cancer)",
                         "Human Toxicity (non-cancer)")) %>%
  mutate(phases = fct_relevel(phases, "production_norm", "transportation_norm
", "end_of_life_norm"))

ggplot(data = sel_al_cont_long,
       aes(y= amount,
           fill = phases,
           x = Category)) +
            geom_bar(stat = "identity",
                     position = position_dodge(),
                     show.legend = TRUE) +
  scale_fill_futurama() +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Contribution to Lifecycle Phase",
       subtitle = "Aluminum Can",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  scale_fill_futurama(name = "Phase", labels = c("Production", "End of Life", "Transportation")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  # coord_flip() +
    theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())

ggsave(here::here("figures", "aluminum_contribution_f2.png"), height = 6, width = 8)

```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=TRUE}
# Contribution: Glass


glass_cont_long <- read_csv(here::here("data", "glass_contribution.csv")) %>%
  select(production_norm, transportation_norm, end_of_life_norm, Category) %>%
  pivot_longer(!Category, names_to = "phases", values_to = "amount")

sel_glass_cont_long <-  glass_cont_long %>% 
  filter(Category %in% c("Acidification",
                         "Ecotoxicity",
                         "Eutrophication",
                         "Global Warming Air",
                         "Smog Air",
                         "Human Toxicity (cancer)",
                         "Human Toxicity (non-cancer)")) %>%
  mutate(phases = fct_relevel(phases, "production_norm", "transportation_norm
", "end_of_life_norm"))

ggplot(data = sel_glass_cont_long,
       aes(y= amount,
           fill = phases,
           x = Category)) +
            geom_bar(stat = "identity",
                     position = position_dodge(),
                     show.legend = TRUE) +
  scale_fill_futurama() +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Contribution to Lifecycle Phase",
       subtitle = "Glass Bottle",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  scale_fill_futurama(name = "Phase", labels = c("Production", "End of Life", "Transportation")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  # coord_flip() +
    theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())

ggsave(here::here("figures", "glass_contribution_f2.png"), height = 6, width = 8)

```

```{r echo=FALSE, error=FALSE, message=FALSE, warning=FALSE, include=TRUE}
# Contribution: PET


pet_cont_long <- read_csv(here::here("data", "pet_contribution.csv")) %>%
  select(production_norm, transportation_norm, end_of_life_norm, Category) %>%
  pivot_longer(!Category, names_to = "phases", values_to = "amount")

sel_pet_cont_long <-  pet_cont_long %>% 
  filter(Category %in% c("Acidification",
                         "Ecotoxicity",
                         "Eutrophication",
                         "Global Warming Air",
                         "Smog Air",
                         "Human Toxicity (cancer)",
                         "Human Toxicity (non-cancer)")) %>%
  mutate(phases = fct_relevel(phases, "production_norm", "transportation_norm
", "end_of_life_norm"))

ggplot(data = sel_pet_cont_long,
       aes(y= amount,
           fill = phases,
           x = Category)) +
            geom_bar(stat = "identity",
                     position = position_dodge(),
                     show.legend = TRUE) +
  scale_fill_futurama() +
  labs(x = "Environmental Impact Category",
       y = "Relative to Baseline (EPA)",
       title = "Contribution to Lifecycle Phase",
       subtitle = "PET Bottle",
       caption = "Global Warming Air includes biogenic carbon.\nAll values were normalized to EPA baseline measures.\n\nESM 273: Winter 2021\nKeene Morrow") +
  scale_fill_futurama(name = "Phase", labels = c("Production", "End of Life", "Transportation")) +
  scale_x_discrete(labels = c("Acidification" = "Acidification",
                              "Ecotoxicity" = "Ecotoxicity",
                              "Eutrophication" = "Eutrophication",
                              "Global Warming Air" = "Global\nWarming\nAir",
                              "Smog Air" = "Smog Air",
                              "Human Toxicity (cancer)" = "Human\nToxicity\n(cancer)",
                              "Human Toxicity (non-cancer)" = "Human\nToxicity\n(non-cancer)")) +
  theme_minimal() +
  theme(legend.position = "top",
        plot.caption = element_text(hjust = 0, face = "italic")) +
  # coord_flip() +
    theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank())

ggsave(here::here("figures", "PET_contribution_f2.png"), height = 6, width = 8)

```




***

### Introduction


#### General Aspects

Keene Morrow

18 March 2021

This study has been conducted according to the requirements of ISO 14044:2006(E).



#### Goal of the Study

This study was conducted as a class exercise for ESM 273: Life Cycle Assessment at the Bren School of Environmental Science & Management, University of California, Santa Barbara.  It is intended for use in that context alone and will not be used to support comparative assertions disclosed to the public.



### Data and methods

#### Scope of the Study





#### LC Inventory Analysis

(detailed explanation of the inventory modeling)



### Results

#### LC Impact Assessment

(brief explanations of the selected impact indicators)


#### LC Interpetation

(results, assumptions, limitation, sensitivity analysis, recommendations, conclusions)

### Discussion and conclusions



### References



